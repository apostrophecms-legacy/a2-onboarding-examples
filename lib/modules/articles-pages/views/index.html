{# lib/modules/people-pages/views/index.html #}
{% extends "layout.html" %}
{% block title %}{{ data.page.title }}{% endblock %}

{% block main %}
<div class="main-content">
  <h1>{{ data.page.title }}</h1>
  <div class="tag-filters">
    <h3>Tags</h3>
    <ul>
      {% for tag in data.piecesFilters.tags %}
        {% set isActive = data.query.tags === tag.value %}
        {% set tagValue = '' if isActive else tag.value %}

        <li
          {% if isActive %}
            class="active"
          {% endif %}
        >
          <a href="{{ data.url | build({ tags: tagValue  }) }}">
            {{ tag.label }} ({{ tag.count }})
          </a>
        </li>
      {% endfor %}
    </ul>
  </div>
  <ul class="articles-list">
    {% for piece in data.pieces %}
      {% set image = apos.images.first(piece.image) %}
      <li>
        <a href="{{ piece._url }}">
          <h2>{{ piece.title }}</h2>

          {% if image %}
            <img src="{{ apos.attachments.url(image) }}" />
          {% endif %}

          {{ apos.singleton(piece, 'content', 'apostrophe-rich-text') }}
        </a>
      </li>
    {% endfor %}
  </ul>

</div>


  {% import 'apostrophe-pager:macros.html' as pager with context %}
  {{
    pager.render({
      page: data.currentPage,
      total: data.totalPages
    }, data.url)
  }}
{% endblock %}
